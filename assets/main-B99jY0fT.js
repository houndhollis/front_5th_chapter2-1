import"./modulepreload-polyfill-B5Qt9EMX.js";const c=[{id:"p1",name:"상품1",price:1e4,quantity:50},{id:"p2",name:"상품2",price:2e4,quantity:30},{id:"p3",name:"상품3",price:3e4,quantity:20},{id:"p4",name:"상품4",price:15e3,quantity:0},{id:"p5",name:"상품5",price:25e3,quantity:10}],g={p1:.1,p2:.15,p3:.2,p4:.05,p5:.25},m=()=>{const t=document.getElementById("product-select");t.innerHTML="",c.forEach(e=>{const n=document.createElement("option");n.value=e.id,n.textContent=e.name+" - "+e.price+"원",e.quantity===0&&(n.disabled=!0),t.appendChild(n)})};function y(t,e,n){setTimeout(()=>{setInterval(t,e)},Math.random()*n)}function x(){const t=c[Math.floor(Math.random()*c.length)];Math.random()<.3&&t.quantity>0&&(t.price=Math.round(t.price*.8),alert(`번개세일! ${t.name}이(가) 20% 할인 중입니다!`),m())}function h(){const t=document.getElementById("product-select").value;if(t){const e=c.find(n=>n.id!==t&&n.quantity>0);e&&(alert(`${e.name}은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!`),e.price=Math.round(e.price*.95),m())}}y(x,3e4,1e4);y(h,6e4,2e4);const f=()=>{const t=document.createElement("h1");return t.className="text-2xl font-bold mb-4",t.textContent="장바구니",t},C=()=>{const t=document.createElement("select");return t.id="product-select",t.className="border rounded p-2 mr-2",t},E=()=>{const t=document.createElement("div");return t.className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl mt-8 p-8",t},I=t=>`<div id="${t.id}" class="flex justify-between items-center mb-2">
      <span>${t.name} - ${t.price}원 x 1</span> 
      <div>
        <button 
          class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" 
          data-change="-1"
        >
          -
        </button>
        <button 
          class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" 
          data-change="1"
        >
          +
        </button> 
        <button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">
          삭제
        </button>
      </div>
    </div>`,b=()=>{const t=document.createElement("span");return t.id="loyalty-points",t.className="text-blue-500 ml-2",t},q=()=>{const t=document.createElement("button");return t.id="add-to-cart",t.className="bg-blue-500 text-white px-4 py-2 rounded",t.textContent="추가",t},v=()=>{const t=document.createElement("div");return t.id="cart-total",t.className="text-xl font-bold my-4",t},B=()=>{const t=document.createElement("div");return t.id="stock-status",t.className="text-sm text-gray-500 mt-2",t},w=()=>{const t=document.createElement("div");return t.id="cart-items",t},S=()=>{let t="";c.forEach(function(e){e.quantity<5&&(t+=e.name+": "+(e.quantity>0?"재고 부족 ("+e.quantity+"개 남음)":"품절")+`
`)}),document.getElementById("stock-status").textContent=t},M=t=>{const e=Math.floor(t/1e3),n=b();document.getElementById("loyalty-points")||document.getElementById("cart-total").appendChild(n),n.textContent="(포인트: "+e+")"},T=(t,e,n)=>{let a=0;const i=(n-e)/n;return t>=30?a=Math.max(i,.25):a=i,new Date().getDay()===2&&(a=Math.max(a,.1)),a},p=()=>{let t=0,e=0;const n=document.getElementById("cart-items").children;let a=0;for(let o=0;o<n.length;o++)(function(){let s;for(let u=0;u<c.length;u++)if(c[u].id===n[o].id){s=c[u];break}const r=parseInt(n[o].querySelector("span").textContent.split("x ")[1]),d=s.price*r,l=r>=10?g[s.id]??0:0;e+=r,a+=d,t+=d*(1-l)})();const i=T(e,t,a);if(document.getElementById("cart-total").textContent="총액: "+Math.round(t)+"원",i>0){const o=document.createElement("span");o.className="text-green-500 ml-2",o.textContent="("+(i*100).toFixed(1)+"% 할인 적용)",document.getElementById("cart-total").appendChild(o)}S(),M(t)};function D(){const t=document.getElementById("app"),e=E();e.appendChild(f()),e.appendChild(w()),e.appendChild(v()),e.appendChild(C()),e.appendChild(q()),e.appendChild(B()),t.appendChild(e),m(),p()}D();document.getElementById("add-to-cart").addEventListener("click",()=>{const t=document.getElementById("product-select").value,e=c.find(n=>n.id===t);if(e&&e.quantity>0){const n=document.getElementById(e.id);if(n){const a=parseInt(n.querySelector("span").textContent.split("x ")[1])+1;a<=e.quantity?(n.querySelector("span").textContent=e.name+" - "+e.price+"원 x "+a,e.quantity--):alert("재고가 부족합니다.")}else document.getElementById("cart-items").innerHTML+=I(e),e.quantity--;p()}});document.getElementById("cart-items").addEventListener("click",t=>{const e=t.target,n=e.classList.contains("quantity-change"),a=e.classList.contains("remove-item");if(n||a){const i=e.dataset.productId,o=document.getElementById(i),s=o.querySelector("span"),r=c.find(d=>d.id===i);if(n){const d=parseInt(e.dataset.change),l=parseInt(s.textContent.split("x ")[1])+d;l>0&&l<=r.quantity+parseInt(s.textContent.split("x ")[1])?(s.textContent=s.textContent.split("x ")[0]+"x "+l,r.quantity-=d):alert("재고가 부족합니다.")}else a&&o.remove();p()}});
